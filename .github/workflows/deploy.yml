name: Deploy to Production

on:
  push:
    branches:
      - main

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v2

    - name: Set up Ruby and Bundler
      run: |
        echo "::set-env name=RUBY_VERSION::3.2.2" # Set the desired Ruby version
        echo "::add-path::/home/runner/work/_temp/_github_home/rubygems/bin"
        gem install bundler

    - name: Install dependencies
      run: |
        bundle config path vendor/bundle
        bundle install --jobs 4 --retry 3

    - name: Deploy to Production
      run: cap production deploy
